\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{setspace}
\setstretch{1.2}
\usepackage{hanging}
\usepackage{indentfirst}

\begin{document}

\begin{center}
\section{ARM TrustZone Exploitation and Secure Monitor Vulnerabilities}
\section{Team Members: Nathaniel Smith \& Michael Bialas}
\end{center}
\section{Problem Statement:}\par
\indent ARM TrustZone is a hardware-backed isolation mechanism that is used across a wide variety of mobile and embedded devices to protect sensitive code and secrets in the secure world while running user applications in the normal world. The Secure Monitor, which mediates world switches through the SMC interface, plays a central role in enforcing this separation. Although TrustZone's security model is strong in theory, real-world implementations, particularly resource or cost-constrained firmware, vendor integrations, weak SoC-level protections, or incomplete isolation, often introduce vulnerabilities in Secure Monitor code paths, firmware updates, peripheral access, and exception handling. These implementation and integration weaknesses can be exploited to escalate privileges in firmware layers. A financial incentive to implement TrustZone inexpensively in a device can lead to such vulnerabilities. This project investigates how flaws in the integration of TrustZone can enable the exploitation of the security protocol.

\section{Proposed methodology:}\par

\indent We will be using a Raspberry Pi 4 as the device of our choice to exploit ARM TrustZone to gain access to the secure world of the hardware and software. We plan to use several attack methods to achieve this. We will first have to install and ensure that OP-TEE (open-source trusted execution environment based on ARM TrustZone) can run on our Raspberry Pi. We will have to load this software on an SD card and boot the Raspberry Pi using it. Once complete, we will be able to attack the installed ARM TrustZone based OP-TEE environment.

\indent For computing resources, we will require a Raspberry Pi 4 with adequate SD card storage (at least 32 GB) to accommodate the OP-TEE build and test environments. Our development environment will use standard Linux tools including GCC toolchain for cross-compilation, Git for version control, and Make for build automation. Additionally, we will need QEMU or similar virtualization capabilities for initial testing and debugging before hardware deployment. Python will be utilized for developing fuzzing harnesses and test automation scripts. We will also require access to ARM documentation and the OP-TEE source code repository for understanding the Secure Monitor implementation and SMC interface specifications.

\indent A documented method to gain unfettered access to TrustZone's secure world is the DMA attack. The Raspberry Pi's direct memory access can be read or tampered with without going through a CPU's typical privilege checks. Within the context of TrustZone, we can attack this peripheral since it lacks proper isolation. There are four specific operations loaded in memory that the OP-TEE kernel uses to determine if software is a Trusted Application. We will overwrite these operations in memory using DMA transactions resulting in the Raspberry Pi trusting any application we load onto it, essentially providing us unrestricted access to OP-TEE's kernel operations. To implement this attack, we will develop custom DMA exploit code in C, leverage memory mapping utilities to identify target addresses, and use kernel-level drivers or direct hardware access mechanisms to execute DMA transactions.

\indent The next method we will be using to demonstrate the insecurity of Secure Monitor in ARM TrustZone is called Fuzzing or fuzz-testing. This technique feeds a large number of unexpected, malformed, random, or specially crafted inputs to the software interface of the Raspberry Pi 4 to find sequences that can crash the device, cause logic errors, and locate security-relevant failures or bugs. It will target the boundary of the normal and secure world that is governed by the Secure Monitor to cause the secure world to misbehave such as faulty memory violations, assertion violations, and deadline/infinite loops. Some hardware aspects that Fuzzing tests within TrustZone are Address Space Randomization (ASLR), Code Integrity Guard, Control Flow Integrity (CFI), Data Execution Prevention (DEP), Memory Management Unit (MMU), and the Memory Protection Unit (MPU). We will first have to prepare specific inputs, generate the fuzz data, send the data to the system under test, monitor the system, analyze the crashes or behavior, and report the bugs discovered. We can do this three different ways, Black-Box, White-Box, or Grey-Box testing. Black-Box fuzzing is the best testing method to simulate an attack with no knowledge of the device's code. White-box fuzzing is better for developers of the hardware that have full knowledge of the source code and the hardware. Grey-Box fuzzing is a mix of both Black-Box and White-Box where the attacker has partial access or knowledge of the SUT. We will be attempting to use a mix of all three approaches. However, since the Raspberry Pi is not fully open source such as the GPU's firmware, White-Box fuzzing may be limited. Common fuzzing techniques include: Random Mutation (Black-Box), Grammar Representation (Black-Box), Dynamic Symbolic Execution (Black-Box), Dynamic Taint Analysis (Black-Box), Guided Covered (Grey-Box), Scheduling Algorithms (Grey-Box), and Static Analysis (White-Box). Of these methods, we will primarily implement Black- and Grey-Box techniques. For the fuzzing framework, we will utilize libFuzzer or AFL (American Fuzzy Lop) to generate and deliver malformed SMC call sequences to the Secure Monitor. We will instrument the OP-TEE environment with custom logging and crash detection mechanisms to monitor and record the system's response to fuzzing inputs. Additionally, we will employ serial debugging interfaces and system log analysis tools to capture crash dumps and behavioral anomalies for subsequent analysis.

\section{Expected Results and Challenges:}\par

\indent We anticipate that both the DMA attack and fuzzing techniques will successfully demonstrate vulnerabilities in the OP-TEE implementation on the Raspberry Pi 4. Specifically, we expect the DMA attack to grant us the ability to overwrite the Trusted Application verification operations in memory, allowing us to load and execute arbitrary code within the secure world. Through fuzzing, we expect to discover logic errors and fault conditions in the Secure Monitor's handling of malformed inputs at the normal-secure world boundary, potentially revealing sequences of SMC calls that trigger memory violations or crash conditions.

\indent However, several challenges may impede our progress. First, the Raspberry Pi 4's GPU firmware is proprietary and closed-source, which will limit our ability to perform comprehensive white-box analysis and may obscure certain attack vectors related to peripheral access. Second, implementing effective DMA attacks requires deep understanding of the Raspberry Pi's memory layout and DMA controller architecture, which may be poorly documented or subject to hardware revisions. Third, developing a robust fuzzing framework that generates meaningful inputs to the SMC interface requires careful study of the Secure Monitor's expected input formats and calling conventions. Additionally, analyzing crash dumps and behavior anomalies from fuzzing may prove time-consuming without adequate instrumentation or debugging facilities within the OP-TEE environment. We may also encounter limitations in modifying or instrumenting the Raspberry Pi's bootloader and firmware to support our testing objectives. Finally, reproducing and validating discovered vulnerabilities across multiple test iterations could present practical challenges related to system stability and recovery.

\section{Related Work:}\par

\indent Prior research has extensively documented vulnerabilities in TrustZone implementations across various platforms and devices. Cerdeira et al. [2] provide a comprehensive systematization of knowledge regarding security vulnerabilities in TrustZone-assisted TEE systems, establishing a foundation for understanding the landscape of known weaknesses. Studies have examined the security of ARM TrustZone in FPGA-based systems of chips, identifying weaknesses in the isolation mechanisms at the hardware level [3]. Attacks exploiting incomplete TrustZone implementations on the Raspberry Pi have been previously analyzed [6], demonstrating that cost-constrained devices often lack adequate peripheral isolation and validating the platform choice for our project. Hardware-based vulnerability attacks against TrustZone have been explored in academic literature [7], showing how attackers can leverage hardware features to compromise the secure world. Additionally, researchers have developed rootkits that operate within the TrustZone environment itself [8, 9], analyzing the impact of a compromised secure world on the entire system and demonstrating privilege escalation paths through the Secure Monitor. Studies on the Android Binder and its interaction with TrustZone have revealed threats and limitations in how the secure world mediates access to critical system resources [8]. Broader quantitative analyses of TEE security have characterized the prevalence of vulnerabilities in production trusted execution environments [4], while mobile device security research has examined how ARM TrustZone is deployed in real-world systems [10]. Additionally, work on securing OP-TEE specifically and using TrustZone for secure resource monitoring in IoT contexts [1, 5] highlights both the potential and the pitfalls of TrustZone-based security in embedded and resource-constrained environments. Our work builds upon these foundations by combining multiple attack methodologies, specifically DMA-based memory manipulation and fuzzing, to systematically explore vulnerabilities in OP-TEE's Secure Monitor implementation on a practical embedded platform.
\section{References:}\par

\hangindent=4em[1] A. Nehal and P. Ahlawat, "Securing IoT Applications with OP-TEE from Hardware-Level OS," in Proc. Int. Conf. on Electronics, Communication and Aerospace Technology (ICECA), 2019.\par

\hangindent=4em[2] D. Cerdeira, N. Santos, P. Fonseca, and S. Pinto, "SoK: Understanding the Prevailing Security Vulnerabilities in TrustZone-Assisted TEE Systems," in Proc. IEEE Symposium on Security and Privacy (S\&P), 2020.\par

\hangindent=4em[3] E. M. Benhani, L. Bossuet, and A. Aubert, "The Security of ARM TrustZone in a FPGA-Based SoC," IEEE Trans. Computers, vol. 68, no. 8, pp. 1238â€“1251, Aug. 2019.\par

\hangindent=4em[4] L. S. Nissankararao, Trusted Yet Vulnerable: A Quantitative Analysis of Trusted Execution Environments (TEE) Security, M.S. Thesis, Univ. of New Hampshire, 2024.\par

\hangindent=4em[5] N. Georgiou, Using ARM TrustZone for Secure Resource Monitoring of IoT Devices Running Contiki-NG, M.Sc. Thesis, KTH Royal Institute of Technology, 2023.\par

\hangindent=4em[6] D. Padrta, Attack Analysis of an Incomplete TrustZone Implementation on the Raspberry Pi, B.Sc. Thesis, Masaryk University, 2024.\par

\hangindent=4em[7] R. Stajnrod, Attacking ARM TrustZone Using Hardware Vulnerability, M.Sc. Thesis, Interdisciplinary Center Herzliya, 2021.\par

\hangindent=4em[8] R. Kiefmann, Threats and Limitations of an ARM TrustZone-Based Rootkit Attacking the Android Binder, Diploma Thesis, TU Wien, 2024.\par

\hangindent=4em[9] D. Marth, Evaluating the ARM TrustZone as an Environment for Rootkits: Analyzing the Impact of a Compromised Secure World, Diploma Thesis, TU Wien, 2021.\par

\hangindent=4em[10] S. D. Yalew, Mobile Device Security with ARM TrustZone, Ph.D. Dissertation, KTH Royal Institute of Technology / Universidade de Lisboa, 2018.\par


\end{document}